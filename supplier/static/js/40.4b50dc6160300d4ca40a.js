webpackJsonp([40],{WXzP:function(t,n,e){var a=e("s7uM");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);e("rjj0")("3699ac77",a,!0)},mMSC:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=e("//Fk"),i=e.n(a),l=e("NYxO"),s=e("jvWE"),o={computed:Object(l.b)(["ticketTypeList","ticketAttractionsList","updateTicketTypeObj"]),data:function(){return{ImageURL1:[],loginId:"",siteId:"",total:0,isUploaNode:!0,addDialog:!1,formLabelWidth:"120px",addOptions:{tm_ts_Code:"",tm_tt_Name:"",tm_tt_TradeInfoID:"",tm_tt_HelpCode:"",tm_tt_Image:"",tm_tt_Description:"",tm_tt_ExpireDay:"",tm_tt_BeforeTime:"",tm_tt_Remark:"",tm_tt_TicketPrice:"",tm_tt_RealPrice:""},ImageURL:[],updateDialog:!1}},methods:{closeDialog:function(){this.ImageURL=[],this.ImageURL1=[],this.addDialog=!1,this.updateDialog=!1},cacheForm:function(){this.ImageURL=[],this.ImageURL1=[],this.addDialog=!1,this.updateDialog=!1},uploadToOSS:function(t){return new i.a(function(n,e){var a=new FormData;a.append("fileToUpload",t);var i=new XMLHttpRequest;i.open("POST",s.a+"/OSSFile/PostToOSS"),i.send(a),i.onreadystatechange=function(){if(4==i.readyState&&200==i.status&&i.responseText){var t=i.responseText;n(JSON.parse(t))}}})},uploaNode:function(){var t=this;setTimeout(function(){t.$refs.upload&&(t.ImageURL=[],t.$refs.upload.addEventListener("change",function(n){for(var e=0;e<t.$refs.upload.files.length;e++)t.uploadToOSS(t.$refs.upload.files[e]).then(function(n){n?(t.ImageURL.push(n.data),t.$refs.upload.value="",t.isUploaNode=!1):t.$notify({message:"图片地址不存在!",type:"error"})})})),t.$refs.upload1&&(t.ImageURL1=[],t.$refs.upload1.addEventListener("change",function(n){for(var e=0;e<t.$refs.upload1.files.length;e++)t.uploadToOSS(t.$refs.upload1.files[e]).then(function(n){n?(t.ImageURL1.push(n.data),t.$refs.upload1.value="",t.isUploaNode=!1):t.$notify({message:"图片地址不存在!",type:"error"})})}))},30)},initTicketAttraction:function(){var t={loginUserID:"huileyou",loginUserPass:"123",operateUserID:"",operateUserName:"",pcName:"",tm_ts_Code:"",tm_ts_Name:"",tm_ts_TradeInfoID:this.loginId.sm_ui_ID,tm_ts_IsDelete:0,tm_ts_IsPass:"",tm_ts_ShowTop:"",tm_ts_IsHot:"",tm_ts_ThemeTypeID:"",page:1,rows:5};this.$store.dispatch("initTicketAttractions",t)},handleCurrentChange:function(t){this.initData("",t)},initData:function(t,n){var e=this,a={loginUserID:"huileyou",loginUserPass:"123",tm_ts_Code:t||"",tm_tt_TradeInfoID:this.loginId.sm_ui_ID,tm_tt_IsDelete:0,page:n||1,rows:5};this.$store.dispatch("initTicketType",a).then(function(t){e.total=t},function(t){e.$notify({message:t,type:"error"})})},search:function(){this.initData(this.siteId)},Add:function(){this.ImageURL=[],this.$store.commit("setTranstionFalse"),this.addDialog=!0,this.isUploaNode&&this.uploaNode()},addSubmit:function(){var t=this;this.addOptions.tm_tt_TradeInfoID=this.loginId.sm_ui_ID,this.addOptions.tm_tt_Image=this.ImageURL.join(",");var n={loginUserID:"huileyou",loginUserPass:"123",data:this.addOptions};this.$store.dispatch("addTicketTypeSubmit",n).then(function(n){t.$notify({message:n,type:"success"}),t.initData()},function(n){t.$notify({message:n,type:"error"})}),this.addDialog=!1},update:function(t){this.ImageURL1=[],this.$store.commit("setTranstionFalse"),this.$store.commit("updateTicketType",t),this.updateDialog=!0,this.isUploaNode&&this.uploaNode()},updateSubmit:function(){var t=this;this.ImageURL1.length&&(this.updateTicketTypeObj.tm_tt_Image=this.ImageURL1.join(","));var n={loginUserID:"huileyou",loginUserPass:"123",data:this.updateTicketTypeObj};this.$store.dispatch("updateTicketTypeSubmit",n).then(function(n){t.$notify({message:n,type:"success"}),t.initData()},function(n){t.$notify({message:n,type:"error"})}),this.updateDialog=!1},deleteTicketType:function(t){var n=this,e={loginUserID:"huileyou",loginUserPass:"123",data:{tm_tt_ID:t}};this.$store.dispatch("deleteTicketType",e).then(function(t){n.$notify({message:t,type:"success"}),n.initData()},function(t){n.$notify({message:t,type:"error"})})}},created:function(){this.loginId=JSON.parse(sessionStorage.getItem("admin")),this.initTicketAttraction(),this.initData()}},r={render:function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("div",{staticClass:"clearfix",attrs:{id:"wrap"}},[e("h1",{staticClass:"userClass"},[t._v("票种")]),t._v(" "),e("el-col",{staticClass:"formSearch",attrs:{span:24}},[e("el-form",{attrs:{inline:!0}},[e("el-form-item",[e("span",[t._v("票种编码筛选:")])]),t._v(" "),e("el-form-item",[e("el-input",{attrs:{size:"mini"},model:{value:t.siteId,callback:function(n){t.siteId=n},expression:"siteId"}})],1),t._v(" "),e("el-form-item",[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.search}},[t._v("查询")]),t._v(" "),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.Add}},[t._v("新增")])],1)],1)],1),t._v(" "),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.ticketTypeList}},[e("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(n){return[e("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[e("el-form-item",{attrs:{label:"票种编码"}},[e("span",[t._v(t._s(n.row.tm_tt_ID))])]),t._v(" "),e("el-form-item",{attrs:{label:"景点名称"}},[e("span",[t._v(t._s(n.row.tm_ts_Name))])]),t._v(" "),e("el-form-item",{attrs:{label:"票种名称"}},[e("span",[t._v(t._s(n.row.tm_tt_Name))])]),t._v(" "),e("el-form-item",{attrs:{label:"商户编码"}},[e("span",[t._v(t._s(n.row.tm_tt_TradeInfoID))])]),t._v(" "),e("el-form-item",{attrs:{label:"票种图片"}},t._l(n.row.tm_tt_Image,function(t,n){return e("img",{key:n,attrs:{src:t,alt:"",width:"300",height:"150"}})})),t._v(" "),e("el-form-item",{attrs:{label:"描述"}},[e("span",[t._v(t._s(n.row.tm_tt_Description))])]),t._v(" "),e("el-form-item",{attrs:{label:"允许超过天数"}},[e("span",[t._v(t._s(n.row.tm_tt_ExpireDay)+"天")])]),t._v(" "),e("el-form-item",{attrs:{label:"提前预定时间"}},[e("span",[t._v(t._s(n.row.tm_tt_BeforeTime)+"分钟")])]),t._v(" "),e("el-form-item",{attrs:{label:"票价"}},[e("span",[t._v(t._s(n.row.tm_tt_TicketPrice)+"元")])]),t._v(" "),e("el-form-item",{attrs:{label:"实际价格"}},[e("span",[t._v(t._s(n.row.tm_tt_RealPrice)+"元")])]),t._v(" "),e("el-form-item",{attrs:{label:"备注"}},[e("span",[t._v(t._s(n.row.tm_tt_Remark))])])],1)]}}])}),t._v(" "),e("el-table-column",{attrs:{label:"票种编码",prop:"tm_tt_ID"}}),t._v(" "),e("el-table-column",{attrs:{label:"票种名称",prop:"tm_tt_Name"}}),t._v(" "),e("el-table-column",{attrs:{label:"景点名称",prop:"tm_ts_Name"}}),t._v(" "),e("el-table-column",{attrs:{label:"实际价格",prop:"tm_tt_RealPrice"}}),t._v(" "),e("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(n){return[e("el-button",{attrs:{size:"mini"},on:{click:function(e){t.update(n.row.tm_tt_ID)}}},[t._v("修改\n          ")]),t._v(" "),e("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){t.deleteTicketType(n.row.tm_tt_ID)}}},[t._v("删除\n          ")])]}}])})],1),t._v(" "),e("el-dialog",{attrs:{title:"添加票种信息",visible:t.addDialog,"close-on-click-modal":!1},on:{"update:visible":function(n){t.addDialog=n},close:t.closeDialog}},[e("el-form",{attrs:{model:t.addOptions}},[e("el-form-item",{attrs:{label:"票种名称:","label-width":t.formLabelWidth}},[e("el-input",{model:{value:t.addOptions.tm_tt_Name,callback:function(n){t.$set(t.addOptions,"tm_tt_Name",n)},expression:"addOptions.tm_tt_Name"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"景点名称:","label-width":t.formLabelWidth}},[e("el-select",{attrs:{placeholder:"请选择"},model:{value:t.addOptions.tm_ts_Code,callback:function(n){t.$set(t.addOptions,"tm_ts_Code",n)},expression:"addOptions.tm_ts_Code"}},t._l(t.ticketAttractionsList,function(t){return e("el-option",{key:t.tm_ts_Code,attrs:{label:t.tm_ts_Name,value:t.tm_ts_Code}})}))],1),t._v(" "),e("el-form-item",{attrs:{label:"票种图片:","label-width":t.formLabelWidth}},[e("a",{staticClass:"file",attrs:{href:"javascript:;"}},[t._v("上传文件\n            "),e("input",{ref:"upload",attrs:{type:"file",name:"",accept:"image/*",multiple:""}})]),t._v(" "),t._l(t.ImageURL,function(n){return e("img",{directives:[{name:"show",rawName:"v-show",value:t.ImageURL.length,expression:"ImageURL.length"}],staticStyle:{display:"block"},attrs:{src:n,width:"280",height:"125"}})})],2),t._v(" "),e("el-form-item",{attrs:{label:"描述:","label-width":t.formLabelWidth}},[e("el-input",{attrs:{type:"textarea"},model:{value:t.addOptions.tm_tt_Description,callback:function(n){t.$set(t.addOptions,"tm_tt_Description",n)},expression:"addOptions.tm_tt_Description"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"允许超过天数:","label-width":t.formLabelWidth}},[e("el-input",{attrs:{placeholder:"请输入数字"},model:{value:t.addOptions.tm_tt_ExpireDay,callback:function(n){t.$set(t.addOptions,"tm_tt_ExpireDay",n)},expression:"addOptions.tm_tt_ExpireDay"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"提前预定时间:","label-width":t.formLabelWidth}},[e("el-input",{attrs:{placeholder:"请输入分钟数且为数字"},model:{value:t.addOptions.tm_tt_BeforeTime,callback:function(n){t.$set(t.addOptions,"tm_tt_BeforeTime",n)},expression:"addOptions.tm_tt_BeforeTime"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"备注:","label-width":t.formLabelWidth}},[e("el-input",{attrs:{type:"textarea"},model:{value:t.addOptions.tm_tt_Remark,callback:function(n){t.$set(t.addOptions,"tm_tt_Remark",n)},expression:"addOptions.tm_tt_Remark"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"票价:","label-width":t.formLabelWidth}},[e("el-input",{attrs:{placeholder:"请输入数字"},model:{value:t.addOptions.tm_tt_TicketPrice,callback:function(n){t.$set(t.addOptions,"tm_tt_TicketPrice",n)},expression:"addOptions.tm_tt_TicketPrice"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"实际价格:","label-width":t.formLabelWidth}},[e("el-input",{attrs:{placeholder:"请输入数字"},model:{value:t.addOptions.tm_tt_RealPrice,callback:function(n){t.$set(t.addOptions,"tm_tt_RealPrice",n)},expression:"addOptions.tm_tt_RealPrice"}})],1)],1),t._v(" "),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.cacheForm}},[t._v("取 消")]),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:t.addSubmit}},[t._v("确 定")])],1)],1),t._v(" "),e("el-dialog",{attrs:{title:"修改票种信息",visible:t.updateDialog,"close-on-click-modal":!1},on:{"update:visible":function(n){t.updateDialog=n},close:t.closeDialog}},[e("el-form",{attrs:{model:t.updateTicketTypeObj}},[e("el-form-item",{attrs:{label:"票种名称:","label-width":t.formLabelWidth}},[e("el-input",{model:{value:t.updateTicketTypeObj.tm_tt_Name,callback:function(n){t.$set(t.updateTicketTypeObj,"tm_tt_Name",n)},expression:"updateTicketTypeObj.tm_tt_Name"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"票种名称:","label-width":t.formLabelWidth}},[e("el-select",{attrs:{placeholder:"请选择"},model:{value:t.updateTicketTypeObj.tm_ts_Code,callback:function(n){t.$set(t.updateTicketTypeObj,"tm_ts_Code",n)},expression:"updateTicketTypeObj.tm_ts_Code"}},t._l(t.ticketAttractionsList,function(t){return e("el-option",{key:t.tm_ts_Code,attrs:{label:t.tm_ts_Name,value:t.tm_ts_Code}})}))],1),t._v(" "),e("el-form-item",{attrs:{label:"票种图片:","label-width":t.formLabelWidth}},[e("a",{staticClass:"file",attrs:{href:"javascript:;"}},[t._v("上传文件\n            "),e("input",{ref:"upload1",attrs:{type:"file",name:"",accept:"image/*",multiple:""}})]),t._v(" "),t._l(t.ImageURL1,function(n){return e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:n,expression:"item"},{name:"show",rawName:"v-show",value:t.ImageURL1.length,expression:"ImageURL1.length"}],attrs:{width:"280",height:"125"}})})],2),t._v(" "),e("el-form-item",{attrs:{label:"描述:","label-width":t.formLabelWidth}},[e("el-input",{attrs:{type:"textarea"},model:{value:t.updateTicketTypeObj.tm_tt_Description,callback:function(n){t.$set(t.updateTicketTypeObj,"tm_tt_Description",n)},expression:"updateTicketTypeObj.tm_tt_Description"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"允许超过天数:","label-width":t.formLabelWidth}},[e("el-input",{attrs:{placeholder:"请输入数字"},model:{value:t.updateTicketTypeObj.tm_tt_ExpireDay,callback:function(n){t.$set(t.updateTicketTypeObj,"tm_tt_ExpireDay",n)},expression:"updateTicketTypeObj.tm_tt_ExpireDay"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"提前预定时间:","label-width":t.formLabelWidth}},[e("el-input",{attrs:{placeholder:"请输入分钟数且为数字"},model:{value:t.updateTicketTypeObj.tm_tt_BeforeTime,callback:function(n){t.$set(t.updateTicketTypeObj,"tm_tt_BeforeTime",n)},expression:"updateTicketTypeObj.tm_tt_BeforeTime"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"备注:","label-width":t.formLabelWidth}},[e("el-input",{attrs:{type:"textarea"},model:{value:t.updateTicketTypeObj.tm_tt_Remark,callback:function(n){t.$set(t.updateTicketTypeObj,"tm_tt_Remark",n)},expression:"updateTicketTypeObj.tm_tt_Remark"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"票价:","label-width":t.formLabelWidth}},[e("el-input",{attrs:{placeholder:"请输入数字"},model:{value:t.updateTicketTypeObj.tm_tt_TicketPrice,callback:function(n){t.$set(t.updateTicketTypeObj,"tm_tt_TicketPrice",n)},expression:"updateTicketTypeObj.tm_tt_TicketPrice"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"实际价格:","label-width":t.formLabelWidth}},[e("el-input",{attrs:{placeholder:"请输入数字"},model:{value:t.updateTicketTypeObj.tm_tt_RealPrice,callback:function(n){t.$set(t.updateTicketTypeObj,"tm_tt_RealPrice",n)},expression:"updateTicketTypeObj.tm_tt_RealPrice"}})],1)],1),t._v(" "),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.cacheForm}},[t._v("取 消")]),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:t.updateSubmit}},[t._v("确 定")])],1)],1),t._v(" "),e("div",{staticClass:"block",staticStyle:{float:"right"}},[e("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.total,expression:"total"}],attrs:{"page-size":5,layout:"total, prev, pager, next",total:t.total},on:{"current-change":t.handleCurrentChange}})],1)],1)])},staticRenderFns:[]};var m=e("VU/8")(o,r,!1,function(t){e("WXzP")},"data-v-37b33aee",null);n.default=m.exports},s7uM:function(t,n,e){(t.exports=e("FZ+f")(!1)).push([t.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])}});